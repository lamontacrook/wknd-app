{"ast":null,"code":"var _s = $RefreshSig$();\n/*\nCopyright 2020 Adobe\nAll Rights Reserved.\n\nNOTICE: Adobe permits you to use, modify, and distribute this file in\naccordance with the terms of the Adobe license agreement accompanying\nit.\n*/\nimport { useState, useEffect } from 'react';\nimport { AEMHeadless } from \"@adobe/aem-headless-client-js\";\nimport { externalizePaths } from '../utils';\nconst {\n  REACT_APP_HOST_URI,\n  REACT_APP_GRAPHQL_ENDPOINT,\n  REACT_APP_AUTHORIZATION\n} = process.env;\n\n/**\n * Custom React Hook to perform a GraphQL query\n * @param query - GraphQL query\n * @param path - Persistent query path\n */\nexport function useGraphQL(query, path) {\n  _s();\n  let [graphQLData, setGraphQLData] = useState(null);\n  let [errors, setErrors] = useState(null);\n  useEffect(() => {\n    const config = {\n      serviceURL: REACT_APP_HOST_URI,\n      endpoint: REACT_APP_GRAPHQL_ENDPOINT\n    };\n    if (REACT_APP_AUTHORIZATION) config.auth = REACT_APP_AUTHORIZATION.split(\":\");\n    const sdk = new AEMHeadless(config);\n    const request = query ? sdk.runQuery.bind(sdk) : sdk.runPersistedQuery.bind(sdk);\n    request(query || path).then(_ref => {\n      let {\n        data,\n        errors\n      } = _ref;\n      if (errors) setErrors(mapErrors(errors));\n      if (data) setGraphQLData(externalizePaths(data));\n    }).catch(error => {\n      setGraphQLData(false);\n      setErrors(error);\n    });\n  }, [query, path]);\n  return {\n    graphQLData,\n    errors\n  };\n}\n\n/**\n * concatenate error messages into a single string.\n * @param {*} errors\n */\n_s(useGraphQL, \"8nAeqCnJsyb4YEWatpZXURrKu0Q=\");\nexport function mapErrors(errors) {\n  return errors.map(error => error.message ? error.message : error).join(\",\");\n}","map":{"version":3,"names":["useState","useEffect","AEMHeadless","externalizePaths","REACT_APP_HOST_URI","REACT_APP_GRAPHQL_ENDPOINT","REACT_APP_AUTHORIZATION","process","env","useGraphQL","query","path","graphQLData","setGraphQLData","errors","setErrors","config","serviceURL","endpoint","auth","split","sdk","request","runQuery","bind","runPersistedQuery","then","data","mapErrors","catch","error","map","message","join"],"sources":["/Users/lamont/Workspace/andy/wknd-app/src/api/useGraphQL.js"],"sourcesContent":["/*\nCopyright 2020 Adobe\nAll Rights Reserved.\n\nNOTICE: Adobe permits you to use, modify, and distribute this file in\naccordance with the terms of the Adobe license agreement accompanying\nit.\n*/\nimport { useState, useEffect } from 'react';\nimport { AEMHeadless } from \"@adobe/aem-headless-client-js\";\nimport { externalizePaths } from '../utils';\n\nconst {\n  REACT_APP_HOST_URI,\n  REACT_APP_GRAPHQL_ENDPOINT,\n  REACT_APP_AUTHORIZATION\n} = process.env;\n\n/**\n * Custom React Hook to perform a GraphQL query\n * @param query - GraphQL query\n * @param path - Persistent query path\n */\nexport function useGraphQL(query, path) {\n  let [graphQLData, setGraphQLData] = useState(null);\n  let [errors, setErrors] = useState(null);\n\n  useEffect(() => {\n    const config = {\n      serviceURL: REACT_APP_HOST_URI,\n      endpoint: REACT_APP_GRAPHQL_ENDPOINT,\n    };\n    if (REACT_APP_AUTHORIZATION) config.auth = REACT_APP_AUTHORIZATION.split(\":\");\n\n    const sdk = new AEMHeadless(config);\n    const request = query ? sdk.runQuery.bind(sdk) : sdk.runPersistedQuery.bind(sdk);\n\n    request(query || path)\n      .then(({ data, errors }) => {\n        if (errors) setErrors(mapErrors(errors));\n        if (data) setGraphQLData(externalizePaths(data));\n      })\n      .catch((error) => {\n        setGraphQLData(false);\n        setErrors(error);\n      });\n  }, [query, path]);\n\n  return { graphQLData, errors }\n}\n\n/**\n * concatenate error messages into a single string.\n * @param {*} errors\n */\nexport function mapErrors(errors) {\n  return errors.map((error) => error.message ? error.message : error).join(\",\");\n}\n"],"mappings":";AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASA,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAC3C,SAASC,WAAW,QAAQ,+BAA+B;AAC3D,SAASC,gBAAgB,QAAQ,UAAU;AAE3C,MAAM;EACJC,kBAAkB;EAClBC,0BAA0B;EAC1BC;AACF,CAAC,GAAGC,OAAO,CAACC,GAAG;;AAEf;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,UAAU,CAACC,KAAK,EAAEC,IAAI,EAAE;EAAA;EACtC,IAAI,CAACC,WAAW,EAAEC,cAAc,CAAC,GAAGb,QAAQ,CAAC,IAAI,CAAC;EAClD,IAAI,CAACc,MAAM,EAAEC,SAAS,CAAC,GAAGf,QAAQ,CAAC,IAAI,CAAC;EAExCC,SAAS,CAAC,MAAM;IACd,MAAMe,MAAM,GAAG;MACbC,UAAU,EAAEb,kBAAkB;MAC9Bc,QAAQ,EAAEb;IACZ,CAAC;IACD,IAAIC,uBAAuB,EAAEU,MAAM,CAACG,IAAI,GAAGb,uBAAuB,CAACc,KAAK,CAAC,GAAG,CAAC;IAE7E,MAAMC,GAAG,GAAG,IAAInB,WAAW,CAACc,MAAM,CAAC;IACnC,MAAMM,OAAO,GAAGZ,KAAK,GAAGW,GAAG,CAACE,QAAQ,CAACC,IAAI,CAACH,GAAG,CAAC,GAAGA,GAAG,CAACI,iBAAiB,CAACD,IAAI,CAACH,GAAG,CAAC;IAEhFC,OAAO,CAACZ,KAAK,IAAIC,IAAI,CAAC,CACnBe,IAAI,CAAC,QAAsB;MAAA,IAArB;QAAEC,IAAI;QAAEb;MAAO,CAAC;MACrB,IAAIA,MAAM,EAAEC,SAAS,CAACa,SAAS,CAACd,MAAM,CAAC,CAAC;MACxC,IAAIa,IAAI,EAAEd,cAAc,CAACV,gBAAgB,CAACwB,IAAI,CAAC,CAAC;IAClD,CAAC,CAAC,CACDE,KAAK,CAAEC,KAAK,IAAK;MAChBjB,cAAc,CAAC,KAAK,CAAC;MACrBE,SAAS,CAACe,KAAK,CAAC;IAClB,CAAC,CAAC;EACN,CAAC,EAAE,CAACpB,KAAK,EAAEC,IAAI,CAAC,CAAC;EAEjB,OAAO;IAAEC,WAAW;IAAEE;EAAO,CAAC;AAChC;;AAEA;AACA;AACA;AACA;AAHA,GA5BgBL,UAAU;AAgC1B,OAAO,SAASmB,SAAS,CAACd,MAAM,EAAE;EAChC,OAAOA,MAAM,CAACiB,GAAG,CAAED,KAAK,IAAKA,KAAK,CAACE,OAAO,GAAGF,KAAK,CAACE,OAAO,GAAGF,KAAK,CAAC,CAACG,IAAI,CAAC,GAAG,CAAC;AAC/E"},"metadata":{},"sourceType":"module"}